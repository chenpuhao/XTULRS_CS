# 湘潭大学图书馆预约系统 - C#语言部分

**此项目已更新V2版本，访问新版本请点击：[XTULRS_CS_V2](https://github.com/chenpuhao/XTULRS_CS_V2)**

## 项目简介
湘潭大学图书馆预约系统是2025年湘大软件工程C语言大作业的一部分。本项目的C#语言部分主要负责实现图形用户界面（GUI）和与底层C语言动态链接库（DLL）的交互，提供用户管理、座位管理、预约管理等功能。

项目链接：[XTULRS_CS](https://github.com/chenpuhao/XTULRS_CS)

## 功能概述
### 1. 用户管理
- 用户注册、登录。
- 修改用户名、密码。
- 设置用户为管理员或普通用户。
- 删除用户。
- 查看用户信息。

### 2. 座位管理
- 添加座位。
- 删除座位。
- 导入/导出座位数据（支持JSON格式）。
- 筛选座位（按房间号、座位号、是否空闲）。
- 清除座位预约。

### 3. 预约管理
- 用户预约座位。
- 取消预约。
- 查看预约记录。
- 筛选预约记录（按房间号、座位号、用户、时间范围）。
- 导出预约记录（支持JSON、Excel格式）。
- 清除所有预约记录。

### 4. 系统管理
- 加载和保存用户、座位、预约数据。
- 动态链接库（DLL）加载和调用。
- 系统退出时释放资源。

## 项目结构
```
LRS/
├── Admin.cs               # 管理员界面
├── User.cs                # 普通用户界面
├── Login.cs               # 登录界面
├── Register.cs            # 注册界面
├── Info.cs                # 用户信息修改界面
├── addUserForm.cs         # 添加用户界面
├── addSeatForm.cs         # 添加座位界面
├── Welcome.cs             # 欢迎界面
├── Program.cs             # 程序入口
├── Dll.cs                 # 动态链接库调用封装
├── Encryption.cs          # 加密与解密工具
├── InputBox.cs            # 自定义输入框
├── Readme.md              # 项目说明文档
├── .gitignore             # Git忽略文件
└── bin/                   # 编译输出目录
```

## 环境要求
- **操作系统**: Windows
- **开发工具**: Visual Studio 或 JetBrains Rider
- **依赖库**:
    - `EPPlus` (用于Excel导出)
    - `System.Text.Json` (用于JSON序列化和反序列化)

## 安装与运行
1. **克隆项目**:
   ```bash
   git clone https://github.com/chenpuhao/XTULRS_CS.git
   cd XTULRS_CS
   ```

2. **安装依赖**:
   使用NuGet安装以下依赖：
    - `EPPlus`

3. **运行项目**:
   打开项目后，设置`Program.cs`为启动项，运行项目。

4. **配置EPPlus许可证**:
   在`Program.cs`中设置EPPlus的许可证：
   ```csharp
   ExcelPackage.LicenseContext = LicenseContext.NonCommercial;
   ```

## 使用说明
### 1. 登录与注册
- 启动程序后，用户需先登录或注册。
- 注册时需填写用户名、邮箱和密码，密码需包含字母和数字，且不少于8位。

### 2. 管理员功能
- **用户管理**: 添加、删除用户，修改用户信息，设置用户权限。
- **座位管理**: 添加、删除座位，导入/导出座位数据，筛选座位。
- **预约管理**: 查看、筛选预约记录，导出预约数据，清除预约记录。

### 3. 普通用户功能
- **预约座位**: 选择空闲座位进行预约。
- **取消预约**: 取消当前预约的座位。
- **查看信息**: 查看和修改个人信息。

## 数据导入与导出
- **座位数据**: 支持JSON格式的导入与导出。
- **预约记录**: 支持JSON、Excel、PDF格式的导出。

## 注意事项
1. **动态链接库**:
    - 确保`libLRS.dll`文件与程序在同一目录下。
    - 程序启动时会验证DLL是否加载成功。

2. **数据安全**:
    - 用户密码使用AES加密存储。
    - 修改密码或用户名后需重新登录以应用更改。

3. **许可证**:
    - 本项目使用EPPlus库，请遵守其许可证要求。

## 贡献
欢迎对本项目提出改进建议或提交代码贡献。请通过GitHub提交Pull Request或Issue。

## 作者
- 亡灵

## 许可证
本项目仅供学习和研究使用，禁止用于商业用途。